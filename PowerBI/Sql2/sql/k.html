<HTML>
<HEAD>
<TITLE>PL/SQL Developer Export</TITLE>
</HEAD>
<BODY>
<TABLE BORDER="1">
<TR><TH>Sql text</TH></TR>
<TR><TD>Select N.Codigoempresa, N.Codigofl, N.Codtpdoc, To_Number(n.Numeronf) NumeroNFGlobus, a.NumeroNF NumeroNFArquivo&nbsp;&nbsp;&nbsp;&nbsp; , n.Serienf SerieGlobus, a.Serie SerieArquivo, n.dataemissaonf EmissaoGlobus, a.DataEmissao EmissaoArquivo&nbsp;&nbsp;&nbsp;&nbsp; , f.Nrforn, n.entradasaidanf, n.naturezaoperacaonf naturezaoperacaoGlobus, a.naturezaoperacao NaturezaOperacaoArquivo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , n.basecalcicmsnf baseICMSGlobus, a.BaseICMS BaseICMSArquivo, n.Icms_Isentanf, n.Icms_Outrasnf&nbsp;&nbsp;&nbsp;&nbsp; , n.valortotalnf ValorTotalGlobus, a.ValorTotalNF ValorTotalArquivo, n.coddoctoesf, n.CodIntNF&nbsp;&nbsp;&nbsp;&nbsp; , n.chavedeacessonfe chavedeacessoGlobus, a.chavedeacesso chavedeacessoArquivo&nbsp;&nbsp;&nbsp;&nbsp; , n.codmodelo ModeloGlobus, a.ModeloNF ModeloArquivo&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(f.Nrinscricaoforn, 'CNPJ') CNPJForncedorGlobus&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(Lpad(a.Cnpjemitente, 14, '0'), 'CNPJ') cnpjFornecedorArquivo&nbsp;&nbsp;&nbsp;&nbsp; , eliminanaonumericos(f.inscestadualforn) IEFornecedorGlobus, a.ieemitente IEFornecedorArquivo&nbsp;&nbsp;&nbsp;&nbsp; , f.rsocialforn RSocialFornecedorGlobus, a.razaosocialemitente RSocialFornecedorArquivo&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(e.Inscricaoempresa, 'CNPJ') CNPJEmpresaGlobus&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(Lpad(a.Cnpjdestinatario, 14, '0'), 'CNPJ') cnpjEmpresaArquivo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , l.iestadualfl IEEmpresaGlobus, a.iedestinatario IEEmpresaArquivo&nbsp;&nbsp;&nbsp;&nbsp; , e.rsocialempresa RSocialEmpresaGlobus, a.razaosocialdestinatario RSocialEmpresaArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.enderecofl EnderecoGlobus, a.enderecodestinatario EnderecoArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.numeroendfl NumeroEndGlobus, a.numeroenddestinatario NumeroEndArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.bairrofl bairroGlobus, a.bairrodestinatario bairroArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.cepfl CEPGlobus, eliminanaonumericos(a.cepdestinatario) cepArquivo, 'EST' Origem&nbsp;&nbsp;&nbsp;&nbsp; , a.IdEmpresa, a.idArquivei, a.Tipo, a.Status, a.Operacao, a.DadosAdicionais, a.ComDiferencas, p.Idparametro&nbsp;&nbsp;&nbsp;&nbsp; , (Select Round(Sum(Valorproduto),2) valorProduto&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; From (Select Nvl(Sum(o.valorunitarioitensnf * o.qtdeitensnf) , 0) valorProduto, CodIntNF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; From est_itensnf o&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Group By CodIntNF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Union All&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Select Nvl(Sum(e.vlrunitarionfservico * e.qtdenfservico), 0) valorProduto, CodIntNF&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; From Est_Nfservico e&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Group By CodIntNF) x&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Where x.CodIntNF = n.CodIntNF ) VlProdutoGlobus, a.valorproduto VlProdutoArquivo&nbsp; From Bgm_Notafiscal N&nbsp;&nbsp;&nbsp;&nbsp; , Bgm_Fornecedor F&nbsp;&nbsp;&nbsp;&nbsp; , Niff_Fis_Arquivei a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , Ctr_Empautorizadas e&nbsp;&nbsp;&nbsp;&nbsp; , Ctr_Filial l&nbsp;&nbsp;&nbsp;&nbsp; , Niff_Fis_Parametrosarquivei p Where n.codigoforn = f.codigoforn&nbsp;&nbsp; And n.chavedeacessonfe = a.chavedeacesso&nbsp;&nbsp; And e.codintempaut = l.codintempaut&nbsp;&nbsp; And l.Codigoempresa = n.codigoEmpresa&nbsp;&nbsp; And l.codigofl = n.codigofl&nbsp;&nbsp; And p.Idempresa = a.Idempresa&nbsp;&nbsp; And a.idEmpresa = 7&nbsp;&nbsp; And a.DataEmissao between To_Date('01/07/2018', 'dd/mm/yyyy')&nbsp;&nbsp;&nbsp; And To_date('05/07/2018', 'dd/mm/yyyy') Union All Select N.Codigoempresa, N.Codigofl, N.Codtpdoc, To_Number(n.nrdocentra) NumeroNFGlobus, a.NumeroNF NumeroNFArquivo&nbsp;&nbsp;&nbsp;&nbsp; , n.serieentra SerieGlobus, a.Serie SerieArquivo, n.dtemissaoentra EmissaoGlobus, a.DataEmissao EmissaoArquivo&nbsp;&nbsp;&nbsp;&nbsp; , f.Nrforn, n.dtentradaentra, null naturezaoperacaoGlobus, a.naturezaoperacao NaturezaOperacaoArquivo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , Sum(n.Icmsbaseentra) baseICMSGlobus, a.BaseICMS BaseICMSArquivo, Sum(n.Icmsisentaentra) Icms_Isentanf, Sum(n.Icmsoutrasentra) Icms_Outrasnf&nbsp;&nbsp;&nbsp;&nbsp; , Sum(n.vlcontabilentra) ValorTotalGlobus, a.ValorTotalNF ValorTotalArquivo&nbsp;&nbsp;&nbsp;&nbsp; , (Select min(codDoctoesf) codDoctoesf From esfEntra e Where e.chavedeacesso = a.chavedeacesso) Coddoctoesf, 0 CodIntNF&nbsp;&nbsp;&nbsp;&nbsp; , n.Chavedeacesso chavedeacessoGlobus, a.chavedeacesso chavedeacessoArquivo&nbsp;&nbsp;&nbsp;&nbsp; , n.codmodelo ModeloGlobus, a.ModeloNF ModeloArquivo&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(f.Nrinscricaoforn, 'CNPJ') CNPJForncedorGlobus&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(Lpad(a.Cnpjemitente, 14, '0'), 'CNPJ') cnpjFornecedorArquivo&nbsp;&nbsp;&nbsp;&nbsp; , eliminanaonumericos(f.inscestadualforn) IEFornecedorGlobus, a.ieemitente IEFornecedorArquivo&nbsp;&nbsp;&nbsp;&nbsp; , f.rsocialforn RSocialFornecedorGlobus, a.razaosocialemitente RSocialFornecedorArquivo&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(e.Inscricaoempresa, 'CNPJ') CNPJEmpresaGlobus&nbsp;&nbsp;&nbsp;&nbsp; , formatacnpjcpf(Lpad(a.Cnpjdestinatario, 14, '0'), 'CNPJ') cnpjEmpresaArquivo&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , l.iestadualfl IEEmpresaGlobus, a.iedestinatario IEEmpresaArquivo&nbsp;&nbsp;&nbsp;&nbsp; , e.rsocialempresa RSocialEmpresaGlobus, a.razaosocialdestinatario RSocialEmpresaArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.enderecofl EnderecoGlobus, a.enderecodestinatario EnderecoArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.numeroendfl NumeroEndGlobus, a.numeroenddestinatario NumeroEndArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.bairrofl bairroGlobus, a.bairrodestinatario bairroArquivo&nbsp;&nbsp;&nbsp;&nbsp; , l.cepfl CEPGlobus, eliminanaonumericos(a.cepdestinatario) cepArquivo, n.sistema Origem&nbsp;&nbsp;&nbsp;&nbsp; , a.IdEmpresa, a.idArquivei, a.Tipo, a.Status, a.Operacao, a.DadosAdicionais, a.ComDiferencas, p.Idparametro&nbsp;&nbsp;&nbsp;&nbsp; , Sum(n.vlcontabilentra) -Sum(n.VLSERVICOENTRA) VlProdutoGlobus, a.valorproduto VlProdutoArquivo&nbsp; From esfentra N&nbsp;&nbsp;&nbsp;&nbsp; , Bgm_Fornecedor F&nbsp;&nbsp;&nbsp;&nbsp; , Niff_Fis_Arquivei a&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; , Ctr_Empautorizadas e&nbsp;&nbsp;&nbsp;&nbsp; , Ctr_Filial l&nbsp;&nbsp;&nbsp;&nbsp; , Niff_Fis_Parametrosarquivei p Where n.codigoforn = f.codigoforn&nbsp;&nbsp; And n.chavedeacesso = a.chavedeacesso&nbsp;&nbsp; And e.codintempaut = l.codintempaut&nbsp;&nbsp; And l.Codigoempresa = n.codigoEmpresa&nbsp;&nbsp; And l.codigofl = n.codigofl&nbsp;&nbsp; And p.Idempresa = a.Idempresa&nbsp;&nbsp; And a.idEmpresa = 7&nbsp;&nbsp; And a.DataEmissao between To_Date('01/07/2018', 'dd/mm/yyyy')&nbsp;&nbsp;&nbsp; And To_date('05/07/2018', 'dd/mm/yyyy')&nbsp;&nbsp; And n.Sistema &lt;&gt; 'EST' Group By n.codigoempresa, n.codigofl, n.codtpdoc, To_number(n.nrdocentra), a.numeronf, n.serieentra&nbsp;&nbsp;&nbsp;&nbsp; , a.Serie, n.dtemissaoentra, a.Dataemissao, f.Nrforn, n.dtentradaentra, a.Naturezaoperacao, a.Baseicms&nbsp;&nbsp;&nbsp;&nbsp; , n.Chavedeacesso, a.Chavedeacesso, n.Codmodelo, a.Modelonf, Formatacnpjcpf(f.Nrinscricaoforn, 'CNPJ')&nbsp;&nbsp;&nbsp;&nbsp; , Formatacnpjcpf(Lpad(a.Cnpjemitente, 14, '0'), 'CNPJ'), Eliminanaonumericos(f.Inscestadualforn)&nbsp;&nbsp;&nbsp;&nbsp; , a.Ieemitente, f.Rsocialforn, a.Razaosocialemitente, Formatacnpjcpf(e.Inscricaoempresa, 'CNPJ')&nbsp;&nbsp;&nbsp;&nbsp; , Formatacnpjcpf(Lpad(a.Cnpjdestinatario, 14, '0'), 'CNPJ'), l.Iestadualfl, a.Iedestinatario, a.Valortotalnf&nbsp;&nbsp;&nbsp;&nbsp; , e.Rsocialempresa, a.Razaosocialdestinatario, l.Enderecofl, a.Enderecodestinatario, l.Numeroendfl&nbsp;&nbsp;&nbsp;&nbsp; , a.Numeroenddestinatario, l.Bairrofl, a.Bairrodestinatario, l.Cepfl, Eliminanaonumericos(a.Cepdestinatario)&nbsp;&nbsp;&nbsp;&nbsp; , n.sistema, a.Idempresa, a.Idarquivei, a.Tipo, a.Status, a.Operacao, a.Dadosadicionais, a.Comdiferencas&nbsp;&nbsp;&nbsp;&nbsp; , p.Idparametro, a.Valorproduto&nbsp;</TD></TR>
</TABLE>
</BODY>
</HTML>
