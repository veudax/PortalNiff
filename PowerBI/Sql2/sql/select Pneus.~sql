SELECT 
  FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,99,'ME',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ) MOTIVO, 
  LpAd(A.CODIGOEMPRESA, 3,'0') || '/' || Lpad(A.CODIGOFL, 3,  '0') Empfil,
  B.DESCRICAOMARCAPNE Marca, 
  C.CODIGOMODELOPNE || ' - ' || C.DESCRICAOMODELOPNE modelo, 
  D.DESCRICAOMEDIDAPNE medida, 
  A.CODIGOFOGOPNEU NroFogo, 
  A.CONDICAOPNEU, 
  FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,0 ,'V',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ) VIDA, 
  FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,99,'K',NULL, TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ) TOTAL_KM, 
  
  DECODE(A.CONDICAOPNEU,'SU', FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,0,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N','A'), 
         DECODE(A.CONDICAOPNEU,'LI',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,0,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'VE',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,0,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,0,'K','30-DEC-1899',TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' )))) NOVO, 
         
  DECODE(A.CONDICAOPNEU,'SU', FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,1,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A'  ), 
         DECODE(A.CONDICAOPNEU,'LI',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,1,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'VE',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,1,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A'), 
         FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,1,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' )))) VIDA1, 

  DECODE(A.CONDICAOPNEU,'SU', FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,2,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'LI',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,2,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'VE',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,2,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,2,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' )))) VIDA2, 
         
  DECODE(A.CONDICAOPNEU,'SU', FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,3,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS')  ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'LI',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,3,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'VE',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,3,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,3,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' )))) VIDA3, 
         
  DECODE(A.CONDICAOPNEU,'SU', FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,4,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS')  ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'LI',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,4,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'VE',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,4,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,4,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' )))) VIDA4, 

  DECODE(A.CONDICAOPNEU,'SU', FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,5,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS')  ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'LI',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,5,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         DECODE(A.CONDICAOPNEU,'VE',FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,5,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ), 
         FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,5,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' )))) VIDA5, 
         
  DECODE(A.CONDICAOPNEU,'SU', NVL(FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,99,'C',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ),0), 
         DECODE(A.CONDICAOPNEU,'LI',NVL(FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,99,'C',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A'  ),0), 
         DECODE(A.CONDICAOPNEU,'VE',NVL(FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,99,'C',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ),0), 
         NVL(FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,99,'C',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' ),0)))) VALOR 
         
FROM 
  PNE_CADASTROPNEU    A, 
  PNE_CADASTROMARCA   B, 
  PNE_CADASTROMODELO  C, 
  PNE_CADASTROMEDIDA  D 
WHERE 
  A.CODIGOMARCAPNE   = B.CODIGOMARCAPNE    and 
  A.CODIGOMODELOPNE  = C.CODIGOMODELOPNE   and 
  A.CODIGOMEDIDAPNE  = D.CODIGOMEDIDAPNE   and 
  A.INCLUINAMEDIAPNEU = 'S'  and 
  (A.DATACOMPRAPNEU BETWEEN TO_DATE('01/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') /* P_COMPRAINI */  and TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') /* P_COMPRAFIN */ 
  or  A.DATASUCATAPNEU BETWEEN TO_DATE('01/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') /* P_SUCATAINI */  and TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') /* P_SUCATAFIN */  --) 
  or (A.CODIGOINTPNEU IN (SELECT CODIGOINTPNEU FROM PNE_SERVICOS_OS 
                           WHERE DATARETORNOSERVICOOS BETWEEN TO_DATE('01/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') /* P_DATAINI */  and TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') /* P_DATAFIN */ ) 
  or  A.CODIGOINTPNEU IN (SELECT G.CODIGOINTPNEU FROM BGM_NOTAFISCAL      F 
                               , PNE_VENDAPNEU     G 
                           WHERE F.CODINTNF    = G.CODINTNF 
                             AND F.ENTRADASAIDANF BETWEEN TO_DATE('01/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') and TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') /* P_VENDAFIN */  ))) 
  and  A.CODIGOFOGOPNEU  BETWEEN '      !' /* P_FOGOINI */  and 'ZZZZZZZ' /* P_FOGOFIN */ 
  and A.CONDICAOPNEU IN ('CA','ES','SU','VE','MA','LI') 
  --and A.CODIGOEMPRESA  BETWEEN 1 and 1 and A.CODIGOFL         BETWEEN 1 /* P_CODIGOFLINI */       and 1 /* P_CODIGOFLFIN */ 
  and ( (A.CONDICAOPNEU IN ('VE','SU')) 
   OR (FC_TRAZKMCUSTOPNEU(A.CODIGOINTPNEU,99,'K',NULL,TO_DATE('31/12/2018 00:00:00', 'DD/MM/YYYY HH24:MI:SS') ,'N' ,'A' )>0)) 
--  And a.CODIGOMODELOPNE = 74 And A.CODIGOMEDIDAPNE = 2
ORDER BY 
  A.CODIGOEMPRESA, 
  A.CODIGOFL, 
  A.ESTRUTURAPNEU, 
  A.CODIGOMARCAPNE, 
  A.CODIGOMODELOPNE, 
  A.CODIGOMEDIDAPNE, 
  A.CODIGOFOGOPNEU 